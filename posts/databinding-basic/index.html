<!DOCTYPE html><html lang="en-US" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="[Android] DataBinding Basic" /><meta property="og:locale" content="en_US" /><meta name="description" content="1. Introduction" /><meta property="og:description" content="1. Introduction" /><link rel="canonical" href="https://hadesptit.github.io/posts/databinding-basic/" /><meta property="og:url" content="https://hadesptit.github.io/posts/databinding-basic/" /><meta property="og:site_name" content="Hades" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2019-03-21T14:15:03+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="[Android] DataBinding Basic" /><meta name="twitter:site" content="@hades_pt" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2019-03-21T14:15:03+00:00","datePublished":"2019-03-21T14:15:03+00:00","description":"1. Introduction","headline":"[Android] DataBinding Basic","mainEntityOfPage":{"@type":"WebPage","@id":"https://hadesptit.github.io/posts/databinding-basic/"},"url":"https://hadesptit.github.io/posts/databinding-basic/"}</script><title>[Android] DataBinding Basic | Hades</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://avatars.githubusercontent.com/u/20601191?s=400" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Hades</a></div><div class="site-subtitle font-italic">Chase excellence success will follow you</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/HadesPTIT" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/hades_pt" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['Hphamptit','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>[Android] DataBinding Basic</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>[Android] DataBinding Basic</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Hades </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Thu, Mar 21, 2019, 2:15 PM +0000" prep="on" > Mar 21, 2019 <i class="unloaded">2019-03-21T14:15:03+00:00</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1329 words">7 min</span></div></div><div class="post-content"><h2 id="1-introduction">1. Introduction</h2><p>Databinding là thư viện cho phép bạn liên kết các thành phần UI trong layout tới các nguồn dữ liệu trong ứng dụng bằng cách khai báo thay vì phải coding.</p><p>Databinding có chút khác biệt so với các layout bình thường. Nó bắt đầu bằng root tag **<layout>**, theo sau đó là **<data>** cuối cùng là root **<view>**</view></data></layout></p><p>Dưới dây là một ví dụ :</p><div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="nt">&lt;layout</span> <span class="na">xmlns:android=</span><span class="s">"http://schemas.android.com/apk/res/android"</span><span class="nt">&gt;</span>
   <span class="nt">&lt;data&gt;</span>
       <span class="nt">&lt;variable</span> <span class="na">name=</span><span class="s">"user"</span> <span class="na">type=</span><span class="s">"com.example.User"</span><span class="nt">/&gt;</span>
   <span class="nt">&lt;/data&gt;</span>
   <span class="nt">&lt;LinearLayout</span>
       <span class="na">android:orientation=</span><span class="s">"vertical"</span>
       <span class="na">android:layout_width=</span><span class="s">"match_parent"</span>
       <span class="na">android:layout_height=</span><span class="s">"match_parent"</span><span class="nt">&gt;</span>
       <span class="nt">&lt;TextView</span> <span class="na">android:layout_width=</span><span class="s">"wrap_content"</span>
           <span class="na">android:layout_height=</span><span class="s">"wrap_content"</span>
           <span class="na">android:text=</span><span class="s">"@{user.firstName}"</span><span class="nt">/&gt;</span>
       <span class="nt">&lt;TextView</span> <span class="na">android:layout_width=</span><span class="s">"wrap_content"</span>
           <span class="na">android:layout_height=</span><span class="s">"wrap_content"</span>
           <span class="na">android:text=</span><span class="s">"@{user.lastName}"</span><span class="nt">/&gt;</span>
   <span class="nt">&lt;/LinearLayout&gt;</span>
<span class="nt">&lt;/layout&gt;</span>
</pre></table></code></div></div><p>Thông thường để khai báo 1 view thông thường sau đó setText cho nó ta thường làm như sau :</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">findViewById</span><span class="o">&lt;</span><span class="nc">TextView</span><span class="o">&gt;(</span><span class="no">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">sample_text</span><span class="o">).</span><span class="na">apply</span> <span class="o">{</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">viewModel</span><span class="o">.</span><span class="na">userName</span>
<span class="o">}</span>
</pre></table></code></div></div><p>Đoạn mã bên dưới đây sẽ cho bạn thấy cách mà DataBinding gắn text vào UI trực tiếp. Điều này giúp loại bỏ việc phải gọi bất cứ dòng code nào như ở bên trên :</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nc">TextView</span>
    <span class="nl">android:</span><span class="nc">Text</span> <span class="o">=</span> <span class="s">"@{viewmodel.userName}"</span> <span class="o">/&gt;</span>
</pre></table></code></div></div><p>Vậy mục đích của nó là gì:</p><ul><li>Giúp giảm thiểu lời gọi trong activities, fragments..<li>Đơn giản, dễ maintain hơn<li>Tăng hiệu năng ứng dụng và tránh memory leak hay NPE.</ul><h2 id="2-data-object">2. Data Object</h2><p>Giả sử bạn có một đối tượng User như sau :</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">data</span> <span class="kd">class</span> <span class="nf">User</span><span class="o">(</span><span class="n">val</span> <span class="nl">firstName:</span> <span class="nc">String</span><span class="o">,</span> <span class="n">val</span> <span class="nl">lastName:</span> <span class="nc">String</span><span class="o">)</span>
</pre></table></code></div></div><p>Khi đó việc biểu diễn @{user.firstName} sử dụng với thuộc tính android:text sẽ truy xuất vào trường firstName của đối tượng.</p><h2 id="3-binding-data">3. Binding Data</h2><p>Một lớp ràng buộc được tự động gen ra cho mỗi file layout. Mặc định, tên của class được dựa trên tên của layout đó bằng cách chuyển đổi nó sang Pascal case và thêm vào hậu tố Binding.</p><p>Ví dụ : activity_main.xml =&gt; ActivityMainBinding</p><p>Lớp này giữ tất cả các ràng buộc từ các thuộc tính layout (VD: biến user) và cách gắn giá trị cho các biểu thức ràng buộc.</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="n">override</span> <span class="n">fun</span> <span class="nf">onCreate</span><span class="o">(</span><span class="nl">savedInstanceState:</span> <span class="nc">Bundle</span><span class="o">?)</span> <span class="o">{</span>
    <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">(</span><span class="n">savedInstanceState</span><span class="o">)</span>
    <span class="n">val</span> <span class="nl">binding:</span> <span class="nc">ActivityMainBinding</span> <span class="o">=</span> <span class="nc">DataBindingUtil</span><span class="o">.</span><span class="na">setContentView</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="no">R</span><span class="o">.</span><span class="na">layout</span><span class="o">.</span><span class="na">activity_main</span><span class="o">)</span>
    <span class="n">binding</span><span class="o">.</span><span class="na">user</span> <span class="o">=</span> <span class="nc">User</span><span class="o">(</span><span class="s">"Test"</span><span class="o">,</span> <span class="s">"User"</span><span class="o">)</span>
<span class="o">}</span>
</pre></table></code></div></div><p>Tại runtime, ứng dụng sẽ hiển thị user Test trên màn hình. Ngoài ra, bạn cũng có thể lấy view sử dụng <strong>LayoutInflater</strong>, được biểu diễn như sau:</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">val</span> <span class="nl">binding:</span> <span class="nc">ActivityMainBinding</span> <span class="o">=</span> <span class="nc">ActivityMainBinding</span><span class="o">.</span><span class="na">inflate</span><span class="o">(</span><span class="n">getLayoutInflater</span><span class="o">())</span>
</pre></table></code></div></div><p>Nếu bạn sử dụng data binding bên trong Fragment,Listview hay RecyclerView adapter, bạn có thể sử dụng phương thức <strong>inflate()</strong> của lớp binding hoặc lớp <strong>DataBindingUtil</strong>.</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">val</span> <span class="n">listItemBinding</span> <span class="o">=</span> <span class="nc">ListItemBinding</span><span class="o">.</span><span class="na">inflate</span><span class="o">(</span><span class="n">layoutInflater</span><span class="o">,</span> <span class="n">viewGroup</span><span class="o">,</span> <span class="kc">false</span><span class="o">)</span>
<span class="c1">// or</span>
<span class="n">val</span> <span class="n">listItemBinding</span> <span class="o">=</span> <span class="nc">DataBindingUtil</span><span class="o">.</span><span class="na">inflate</span><span class="o">(</span><span class="n">layoutInflater</span><span class="o">,</span> <span class="no">R</span><span class="o">.</span><span class="na">layout</span><span class="o">.</span><span class="na">list_item</span><span class="o">,</span> <span class="n">viewGroup</span><span class="o">,</span> <span class="kc">false</span><span class="o">)</span>
</pre></table></code></div></div><h2 id="4-expression-language">4. Expression language</h2><p>Để diễn đạt trong databinding có thể sử dụng 1 số cách diễn đạt sau. Nó cũng tương tự cách biểu diễn trong mã code :</p><ul><li>Mathematical + - / * %<li>String concatenation +<li><div class="table-wrapper"><table><tbody><tr><td>Logical &amp;&amp;<td> </table></div><li><div class="table-wrapper"><table><tbody><tr><td>Binary &amp;<td>^</table></div><li>Unary + - ! ~<li>Shift » »&gt; «<li>Comparison == &gt; &lt; &gt;= &lt;=<li>instanceof<li>Grouping ()<li>Literals - character, String, numeric, null<li>Cast<li>Method calls<li>Field access<li>Array access []<li>Ternary operator ?:</ul><p>Ví dụ :</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nl">android:</span><span class="n">text</span><span class="o">=</span><span class="s">"@{String.valueOf(index+1)}"</span>
<span class="nl">android:</span><span class="n">visibility</span><span class="o">=</span><span class="s">"@{age &lt; 13 ? View.GONE : View.VISIBLE"</span>
<span class="nl">android:</span><span class="n">transitionName</span><span class="o">=</span><span class="err">'@</span><span class="o">{</span><span class="s">"image_"</span> <span class="o">+</span> <span class="n">id</span><span class="o">}</span><span class="err">'</span>
</pre></table></code></div></div><h3 id="41-missing-operators">4.1. Missing Operators</h3><p>Một số operation dưới bị thiếu từ cú pháp biểu diễn mà bạn có thể sử dụng trong các đoạn mã được quản lý :</p><ul><li>this<li>super<li>new<li>Explicit generic invocation</ul><h3 id="42-null-coalescing-operator-">4.2. Null coalescing operator (??)</h3><p>Toán tử kết hợp null (??) này sẽ chọn toán hạng bên trái nếu nó không null còn không thì sẽ chọn bên phải</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nl">android:</span><span class="n">text</span><span class="o">=</span><span class="s">"@{user.displayName ?? user.lastName}"</span>
</pre></table></code></div></div><p>Câu lệnh trên tương đương với :</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nl">android:</span><span class="n">text</span><span class="o">=</span><span class="s">"@{user.displayName != null ? user.displayName : user.lastName}"</span>
</pre></table></code></div></div><h3 id="43-avoid-null-pointer-exceptions">4.3. Avoid null pointer exceptions</h3><p>Mã code được gen với Databinding sẽ tự động check các giá trị null và tránh các Null Pointer Exceptions.</p><p>Ví dụ: Bạn tham chiếu đến @{user.name} mà user đang null thì user.name sẽ được gán giá trị mặc định là null.</p><h3 id="44-collections">4.4. Collections</h3><p>Một số collection phổ biến có thể truy cập bởi toán tử [ ] :</p><ul><li>arrays<li>lists<li>sparse lists<li>map</ul><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="n">data</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="kn">import</span> <span class="nn">type</span><span class="o">=</span><span class="s">"android.util.SparseArray"</span><span class="o">/&gt;</span>
    <span class="o">&lt;</span><span class="kn">import</span> <span class="nn">type</span><span class="o">=</span><span class="s">"java.util.Map"</span><span class="o">/&gt;</span>
    <span class="o">&lt;</span><span class="kn">import</span> <span class="nn">type</span><span class="o">=</span><span class="s">"java.util.List"</span><span class="o">/&gt;</span>
    <span class="o">&lt;</span><span class="n">variable</span> <span class="n">name</span><span class="o">=</span><span class="s">"list"</span> <span class="n">type</span><span class="o">=</span><span class="s">"List&lt;String&gt;"</span><span class="o">/&gt;</span>
    <span class="o">&lt;</span><span class="n">variable</span> <span class="n">name</span><span class="o">=</span><span class="s">"sparse"</span> <span class="n">type</span><span class="o">=</span><span class="s">"SparseArray&lt;String&gt;"</span><span class="o">/&gt;</span>
    <span class="o">&lt;</span><span class="n">variable</span> <span class="n">name</span><span class="o">=</span><span class="s">"map"</span> <span class="n">type</span><span class="o">=</span><span class="s">"Map&lt;String, String&gt;"</span><span class="o">/&gt;</span>
    <span class="o">&lt;</span><span class="n">variable</span> <span class="n">name</span><span class="o">=</span><span class="s">"index"</span> <span class="n">type</span><span class="o">=</span><span class="s">"int"</span><span class="o">/&gt;</span>
    <span class="o">&lt;</span><span class="n">variable</span> <span class="n">name</span><span class="o">=</span><span class="s">"key"</span> <span class="n">type</span><span class="o">=</span><span class="s">"String"</span><span class="o">/&gt;</span>
<span class="o">&lt;/</span><span class="n">data</span><span class="o">&gt;</span>
<span class="err">…</span>
<span class="nl">android:</span><span class="n">text</span><span class="o">=</span><span class="s">"@{list[index]}"</span>
<span class="err">…</span>
<span class="nl">android:</span><span class="n">text</span><span class="o">=</span><span class="s">"@{sparse[index]}"</span>
<span class="err">…</span>
<span class="nl">android:</span><span class="n">text</span><span class="o">=</span><span class="s">"@{map[key]}"</span>
</pre></table></code></div></div><h3 id="45-string-literals">4.5. String Literals</h3><p>Có thể sử dụng nháy đơn hoặc nháy kép để bao quanh giá trị thuộc tính :</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nl">android:</span><span class="n">text</span><span class="o">=</span><span class="err">'@</span><span class="o">{</span><span class="n">map</span><span class="o">[</span><span class="s">"firstName"</span><span class="o">]}</span><span class="err">'</span>
</pre></table></code></div></div><p>hoặc</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nl">android:</span><span class="n">text</span><span class="o">=</span><span class="s">"@{map[`firstName`]}"</span>
</pre></table></code></div></div><h3 id="46-resources">4.6. Resources</h3><p>Có thể sử dụng các giá trị của resource bằng cách khai báo như sau:</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nl">android:</span><span class="n">padding</span><span class="o">=</span><span class="s">"@{large? @dimen/largePadding : @dimen/smallPadding}"</span>
</pre></table></code></div></div><p>Để format strings và plurals cần sử dụng theo format :</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nl">android:</span><span class="n">text</span><span class="o">=</span><span class="s">"@{@string/nameFormat(firstName, lastName)}"</span>
<span class="nl">android:</span><span class="n">text</span><span class="o">=</span><span class="s">"@{@plurals/banana(bananaCount)}"</span>
</pre></table></code></div></div><p>Một số resource yêu cầu rõ ràng loại :</p><h2 id="5-event-handling">5. Event Handling</h2><p>Databinding cho phép bạn diễn đạt xử lý sự kiện. Tên thuộc tính sự kiện được xác định bằng tên của phương thức listener với 1 vài ngoại lệ.</p><p>Ví dụ View.OnClickListener có method onClick(), nên thuộc tính cho sự kiện này là android:onClick. Một số thuộc tính khác như :</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="nl">android:</span><span class="n">onClick</span>
<span class="nl">android:</span><span class="n">onSearchClick</span>
<span class="nl">android:</span><span class="n">onZoomIn</span>
<span class="nl">android:</span><span class="n">onZoomOut</span>
<span class="o">...</span>
</pre></table></code></div></div><p>Trong Databinding có 2 cơ chế xử lý sự kiện :</p><ul><li>Method references :<li>Listener bindings :</ul><h4 id="method-references">Method References</h4><p>Sự khác biệt giữa method references và listener binding là thực tế thì listener implementation được tạo khi data được gắn vào, chứ ko phải khi sự kiện được kích hoạt. =&gt; Nếu bạn muốn evaluate the expresstion khi sự kiện xảy ra. Bạn nên sử dụng listener binding.</p><p>Gỉa sử, để gán một sự kiện cho handler của nó, sử dụng cách binding bình thưởng. ví dụ :</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyHandlers</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onClickFriend</span><span class="o">(</span><span class="nc">View</span> <span class="n">view</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">//TODO</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>Binding expression có thể gán click listener cho view thông qua method onClickFriend() như sau :</p><div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="nt">&lt;layout</span> <span class="na">xmlns:android=</span><span class="s">"http://schemas.android.com/apk/res/android"</span><span class="nt">&gt;</span>
   <span class="nt">&lt;data&gt;</span>
       <span class="nt">&lt;variable</span> <span class="na">name=</span><span class="s">"handlers"</span> <span class="na">type=</span><span class="s">"com.example.MyHandlers"</span><span class="nt">/&gt;</span>
       <span class="nt">&lt;variable</span> <span class="na">name=</span><span class="s">"user"</span> <span class="na">type=</span><span class="s">"com.example.User"</span><span class="nt">/&gt;</span>
   <span class="nt">&lt;/data&gt;</span>
   <span class="nt">&lt;LinearLayout</span>
       <span class="na">android:orientation=</span><span class="s">"vertical"</span>
       <span class="na">android:layout_width=</span><span class="s">"match_parent"</span>
       <span class="na">android:layout_height=</span><span class="s">"match_parent"</span><span class="nt">&gt;</span>
       <span class="nt">&lt;TextView</span> <span class="na">android:layout_width=</span><span class="s">"wrap_content"</span>
           <span class="na">android:layout_height=</span><span class="s">"wrap_content"</span>
           <span class="na">android:text=</span><span class="s">"@{user.firstName}"</span>
           <span class="na">android:onClick=</span><span class="s">"@{handlers::onClickFriend}"</span><span class="nt">/&gt;</span>
   <span class="nt">&lt;/LinearLayout&gt;</span>
<span class="nt">&lt;/layout&gt;</span>
</pre></table></code></div></div><h3 id="listener-binding">Listener binding</h3><p>Listener binding là kiểu binding được chạy khi có sự kiện xảy ra. Nó tương tự method refrenence nhưng nó cho phép bạn chạy các biểu thưc ràng buộc dữ liệu tùy ý.</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Presenter</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onSaveClick</span><span class="o">(</span><span class="nc">Task</span> <span class="n">task</span><span class="o">){}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>Khi đó bạn có thể bind sự kiện tới onSaveClick(), như sau :</p><div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="nt">&lt;layout</span> <span class="na">xmlns:android=</span><span class="s">"http://schemas.android.com/apk/res/android"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;data&gt;</span>
        <span class="nt">&lt;variable</span> <span class="na">name=</span><span class="s">"task"</span> <span class="na">type=</span><span class="s">"com.android.example.Task"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;variable</span> <span class="na">name=</span><span class="s">"presenter"</span> <span class="na">type=</span><span class="s">"com.android.example.Presenter"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/data&gt;</span>
    <span class="nt">&lt;LinearLayout</span> <span class="na">android:layout_width=</span><span class="s">"match_parent"</span> <span class="na">android:layout_height=</span><span class="s">"match_parent"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;Button</span> <span class="na">android:layout_width=</span><span class="s">"wrap_content"</span> <span class="na">android:layout_height=</span><span class="s">"wrap_content"</span>
        <span class="na">android:onClick=</span><span class="s">"@{() -&gt; presenter.onSaveClick(task)}"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/LinearLayout&gt;</span>
<span class="nt">&lt;/layout&gt;</span>
</pre></table></code></div></div><h3 id="import-variables-include">Import, variables, include</h3><p>Databinding cung cấp 1 số feature như import, variable, includes. Import giúp việc tham chiếu đến class bên trong layout của bạn đơn giản hơn. Variable cho phép bạn miêu tả đối tượng</p><h3 id="type-aliases">Type Aliases</h3><p>Khi có xung đột về tên lớp, một trong các lớp có thể được đổi thành bí danh. (alias) Ví dụ sau đây sẽ rename View class trong package com.example.real.estate thành Vista :</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="kn">import</span> <span class="nn">type</span><span class="o">=</span><span class="s">"android.view.View"</span><span class="o">/&gt;</span>
<span class="o">&lt;</span><span class="kn">import</span> <span class="nn">type</span><span class="o">=</span><span class="s">"com.example.real.estate.View"</span>
        <span class="n">alias</span><span class="o">=</span><span class="s">"Vista"</span><span class="o">/&gt;</span>
</pre></table></code></div></div><h3 id="imported-other-class">Imported other class</h3><div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="nt">&lt;data&gt;</span>
    <span class="nt">&lt;import</span> <span class="na">type=</span><span class="s">"com.example.User"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;import</span> <span class="na">type=</span><span class="s">"java.util.List"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;variable</span> <span class="na">name=</span><span class="s">"user"</span> <span class="na">type=</span><span class="s">"User"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;variable</span> <span class="na">name=</span><span class="s">"userList"</span> <span class="na">type=</span><span class="s">"List&lt;User&gt;"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/data&gt;</span>
</pre></table></code></div></div><p>Imported types có thể sử dụng khi tham chiếu các trường hay method static. Đoạn code sau imports lớp MyStringUtils và tham chiếu đến lớp capitalize của nó :</p><div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="nt">&lt;data&gt;</span>
    <span class="nt">&lt;import</span> <span class="na">type=</span><span class="s">"com.example.MyStringUtils"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;variable</span> <span class="na">name=</span><span class="s">"user"</span> <span class="na">type=</span><span class="s">"com.example.User"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/data&gt;</span>
…
<span class="nt">&lt;TextView</span>
   <span class="na">android:text=</span><span class="s">"@{MyStringUtils.capitalize(user.lastName)}"</span>
   <span class="na">android:layout_width=</span><span class="s">"wrap_content"</span>
   <span class="na">android:layout_height=</span><span class="s">"wrap_content"</span><span class="nt">/&gt;</span>
</pre></table></code></div></div><h2 id="6-conclusion">6. Conclusion</h2><p>Trên đây là phần mở đầu về data binding, hi vọng bài viết có thể giúp các bạn có cái nhìn tổng quan về databinding và cách dùng cơ bản. Trong bài viết sau mình sẽ cùng tìm hiểu về cách sử dụng data binding với LiveData, binding adapter…</p><p>Cảm ơn các bạn đã đọc bài viết. Happy coding ^^</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/android/'>Android</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/android/" class="post-tag no-text-decoration" >android</a> <a href="/tags/data-binding/" class="post-tag no-text-decoration" >data binding</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=[Android] DataBinding Basic - Hades&url=https://hadesptit.github.io/posts/databinding-basic/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=[Android] DataBinding Basic - Hades&u=https://hadesptit.github.io/posts/databinding-basic/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=[Android] DataBinding Basic - Hades&url=https://hadesptit.github.io/posts/databinding-basic/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://hadesptit.github.io/posts/databinding-basic/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/flutter/">flutter</a> <a class="post-tag" href="/tags/dart/">dart</a> <a class="post-tag" href="/tags/rxjava/">rxjava</a> <a class="post-tag" href="/tags/kotlin/">kotlin</a> <a class="post-tag" href="/tags/new/">new</a> <a class="post-tag" href="/tags/performance/">performance</a> <a class="post-tag" href="/tags/android-studio/">android studio</a> <a class="post-tag" href="/tags/as/">as</a> <a class="post-tag" href="/tags/cicd/">cicd</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/android-structure/"><div class="card-body"> <span class="timeago small" > Aug 12, 2016 <i class="unloaded">2016-08-12T14:15:03+00:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[Android] Cách tổ chức thư mục cho 1 project Android</h3><div class="text-muted small"><p> Hi mọi người! Dạo gần đây mình có xây dựng 1 dự án android nhỏ. Dưới đây là một cách tổ chức thư mục mà mình cho là khá hợp lý. Hi vọng mọi người có thể tham khảo và góp ý. ├─ com.abc │ ├─ activ...</p></div></div></a></div><div class="card"> <a href="/posts/android-recycler-view/"><div class="card-body"> <span class="timeago small" > Jul 12, 2018 <i class="unloaded">2018-07-12T14:15:03+00:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[Android] RecyclerView</h3><div class="text-muted small"><p> Giới thiệu RecycleView là một viewGroup mới được giới thiệu trong Android L (API 21). Là một viewGroup có chức năng tương tự như ListView nhưng linh hoạt hơn rất nhiều. ListView chỉ hỗ trợ bạn sc...</p></div></div></a></div><div class="card"> <a href="/posts/luu-y-khi-su-dung-string-xml/"><div class="card-body"> <span class="timeago small" > Aug 8, 2018 <i class="unloaded">2018-08-08T14:15:03+00:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[Android] Một số lưu ý khi sử dụng strings.xml</h3><div class="text-muted small"><p> Hi mọi người! Trong bài viết này mình sẽ chia sẻ một số lưu ý khi làm việc với strings.xml. Đừng dùng lại Đừng sử dụng lại strings cho nhiều màn hình khác nhau. 1. Tưởng tượng rằng bạn có một...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/kotlin-sealed-class/" class="btn btn-outline-primary" prompt="previous"><p>[Android] Kotlin Sealed Class</p></a> <a href="/posts/android-paging-library/" class="btn btn-outline-primary" prompt="next"><p>[Android] Architecture Components : Paging Library</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://github.com/HadesPTIT">Hades</a>.</p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/flutter/">flutter</a> <a class="post-tag" href="/tags/dart/">dart</a> <a class="post-tag" href="/tags/rxjava/">rxjava</a> <a class="post-tag" href="/tags/kotlin/">kotlin</a> <a class="post-tag" href="/tags/new/">new</a> <a class="post-tag" href="/tags/performance/">performance</a> <a class="post-tag" href="/tags/android-studio/">android studio</a> <a class="post-tag" href="/tags/as/">as</a> <a class="post-tag" href="/tags/cicd/">cicd</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://HadesPTIT.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
